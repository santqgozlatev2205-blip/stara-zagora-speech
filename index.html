<!DOCTYPE html>
<html lang="bg">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Stara Zagora Speech</title>

<link rel="manifest" href="manifest.json">

<style>
body{margin:0;font-family:Arial;background:#000;color:#fff}
.header{display:flex;align-items:center}
.line{background:#0a7d13;font-size:42px;padding:10px 18px}
.dirWrap{overflow:hidden;flex:1}
.dir{white-space:nowrap;display:inline-block;padding-left:100%;
animation:scroll 18s linear infinite}
@keyframes scroll{from{transform:translateX(0)}to{transform:translateX(-100%)}}

.info{text-align:center;font-size:22px;margin:10px}
.time{text-align:center;font-size:18px;opacity:.8;margin-bottom:10px}

select{width:95%;font-size:18px;margin:10px;background:#000;color:#fff}
select option.endOption{color:orange}

ul{list-style:none;padding:0;margin:0}
li{padding:6px 12px;border-bottom:1px solid #222}
.current{color:#ff4d4d}
.next{color:#6bff6b}
.end{color:orange}

button{font-size:18px;margin:10px;padding:10px;width:95%}
footer{font-size:12px;opacity:.6;text-align:center;margin:10px}
</style>
</head>

<body>

<div class="header">
  <div class="line">71</div>
  <div class="dirWrap">
    <div class="dir">–∫–≤. –ó–æ—Ä–∞ ‚Äì –∫–≤. –ñ–µ–ª–µ–∑–Ω–∏–∫ –ø—Ä–µ–∑ –°—Ç–∞–¥–∏–æ–Ω –ë–µ—Ä–æ–µ</div>
  </div>
</div>

<button id="audioBtn">üîä –í–∫–ª—é—á–∏ –∑–≤—É–∫</button>

<div class="info" id="label">–°–ø–∏—Ä–∫–∞ / Bus stop</div>
<div class="info" id="currentStop"></div>

<div class="info">–ò–∑–±–µ—Ä–∏ –∫—Ä–∞–π–Ω–∞ —Å–ø–∏—Ä–∫–∞</div>
<select id="endSelect"></select>

<ul id="stops"></ul>

<div class="time" id="time"></div>

<footer>Stara Zagora Speech ¬∑ –∞–≤—Ç–æ—Ä: –ö–∏—Ä–∏–ª –ö–∏—Ä–∏–ª–æ–≤-ivanovkiko72@gmail.com</footer>

<script>
const stops=[
{name:"–ó–æ—Ä–∞ - –û–±—Ä—ä—â–∞–ª–æ",lat:42.424226,lon:25.68831,file:"zora_obrushtalo"},
{name:"–ó–æ—Ä–∞ - 2",lat:42.4265,lon:25.6875,file:"zora_2"},
{name:"–ó–æ—Ä–∞ - 1",lat:42.4281,lon:25.686,file:"zora_1"},
{name:"–ú–µ—Ç—Ä–æ –ó–æ—Ä–∞",lat:42.43087,lon:25.68417,file:"metro_zora"},
{name:"–°–ø–∏—Ä–∫–∞",lat:42.4315,lon:25.683,file:"spirka"},
{name:"–°–ë–ê",lat:42.432,lon:25.682,file:"sba"},
{name:"–°–ø–æ—Ä—Ç–Ω–∞ –∑–∞–ª–∞",lat:42.428153,lon:25.658405,file:"sportna_zala"},
{name:"–î–ó–£",lat:42.427892,lon:25.653642,file:"dzu"},
{name:"–ö—Ä–∞–π—Ä–µ—á–µ–Ω –∏–∑—Ç–æ–∫",lat:42.431329,lon:25.643576,file:"krairechen_iztok"},
{name:"–¢–µ—Ö–Ω–∏–∫—É–º–∏ —Å–µ–≤–µ—Ä",lat:42.431909,lon:25.640756,file:"tehnikumi_sever"},
{name:"–ö–∞—É—Ñ–ª–∞–Ω–¥ –ë–µ–¥–µ—á–∫–∞ –∏–∑—Ç–æ–∫",lat:42.434173,lon:25.637058,file:"kaufland_bedechka_iztok"},
{name:"–ü–ó –ó–∞–≥–æ—Ä–∫–∞ –∑–∞–ø–∞–¥",lat:42.441585,lon:25.633277,file:"pz_zagorka_zapad"},
{name:"–ú–æ–ª –ì–∞–ª–µ—Ä–∏—è",lat:42.43812,lon:25.631661,file:"mol_galeria"},
{name:"–¢–î –Ω–∞ –ù–ê–ü",lat:42.434237,lon:25.628527,file:"nap"},
{name:"–ö–∏–ø–∞—Ä–∏—Å",lat:42.431285,lon:25.620854,file:"kiparis"},
{name:"–°—Ç–∞–¥–∏–æ–Ω –ë–µ—Ä–æ–µ",lat:42.431219,lon:25.617108,file:"stadion_beroe"},
{name:"–°–ø–æ—Ä—Ç–Ω–∞ 1",lat:42.428664,lon:25.616594,file:"sportna_1"},
{name:"–ú–ª–µ—á–Ω–∞ –∫—É—Ö–Ω—è",lat:42.426005,lon:25.61107,file:"mlechna_kuhnia"},
{name:"–ù–µ–æ–ª–∏—Ç–Ω–∏ –∂–∏–ª–∏—â–∞",lat:42.424834,lon:25.609599,file:"neolitni_jilishta"},
{name:"–¢—Ä–∏ —á—É—á—É—Ä–∞",lat:42.4179,lon:25.605246,file:"tri_chuchura"},
{name:"–ñ–µ–ª–µ–∑–Ω–∏–∫ –∏–∑—Ç–æ–∫ 2",lat:42.415722,lon:25.599217,file:"jheleznik_iztok_2"},
{name:"–ñ–µ–ª–µ–∑–Ω–∏–∫ –∏–∑—Ç–æ–∫ 1",lat:42.414581,lon:25.596919,file:"jheleznik_iztok_1"},
{name:"–ñ–µ–ª–µ–∑–Ω–∏–∫ –†–ü–£",lat:42.412772,lon:25.592275,file:"jheleznik_rpu"},
{name:"–°–û–£ –ñ–µ–ª–µ–∑–Ω–∏–∫",lat:42.412613,lon:25.586999,file:"sou_jheleznik"},
{name:"–ñ–µ–ª–µ–∑–Ω–∏–∫ - 2",lat:42.410353,lon:25.587765,file:"jheleznik_2"},
{name:"–ñ–µ–ª–µ–∑–Ω–∏–∫ - –û–±—Ä—ä—â–∞–ª–æ",lat:42.410706,lon:25.592148,file:"jheleznik_obrushtalo"}
];

let current = 0;
let end = stops.length-1;
let audioEnabled=false;

const list=document.getElementById("stops");
const sel=document.getElementById("endSelect");
const label=document.getElementById("label");
const currentStop=document.getElementById("currentStop");

document.getElementById("audioBtn").onclick=()=>audioEnabled=true;

function render(){
 list.innerHTML="";
 sel.innerHTML="";

 for(let i=current;i<stops.length;i++){
  const li=document.createElement("li");
  li.textContent=stops[i].name;

  if(i===current) li.classList.add("current");
  if(i===current+1) li.classList.add("next");
  if(i===end) li.classList.add("end");

  list.appendChild(li);

  const o=document.createElement("option");
  o.value=i;
  o.textContent=stops[i].name;
  if(i===end) o.classList.add("endOption");
  sel.appendChild(o);
 }

 // –õ–û–ì–ò–ß–ù–ê –°–ú–Ø–ù–ê –ù–ê –¢–ï–ö–°–¢–ê
 label.textContent =
  current < end
   ? "–°–ª–µ–¥–≤–∞—â–∞ —Å–ø–∏—Ä–∫–∞ / Next stop"
   : "–°–ø–∏—Ä–∫–∞ / Bus stop";

 currentStop.textContent = stops[current].name;
}

sel.onchange=e=>{
 end=+e.target.value;
 render();
};

render();

// GPS (–Ω–∞ –ª–∞–ø—Ç–æ–ø –º–æ–∂–µ –¥–∞ –Ω–µ —Å–º–µ–Ω—è —á–µ—Å—Ç–æ ‚Äì —Ç–æ–≤–∞ –µ –Ω–æ—Ä–º–∞–ª–Ω–æ)
navigator.geolocation.watchPosition(
 pos=>{
  const here={lat:pos.coords.latitude,lon:pos.coords.longitude};
  for(let i=current+1;i<stops.length;i++){
   const d=Math.hypot(here.lat-stops[i].lat,here.lon-stops[i].lon);
   if(d<0.00035){
    current=i;
    render();
    if(audioEnabled)new Audio(stops[i].file+".mp3").play();
    break;
   }
  }
 },
 err=>console.warn(err.message),
 {enableHighAccuracy:true}
);

// –î–ê–¢–ê + –ß–ê–°
setInterval(()=>{
 const d=new Date();
 document.getElementById("time").textContent=
  d.toLocaleString("bg-BG",{
   weekday:"long",
   day:"2-digit",
   month:"2-digit",
   year:"numeric",
   hour:"2-digit",
   minute:"2-digit"
  });
},1000);
</script>

</body>
</html>






